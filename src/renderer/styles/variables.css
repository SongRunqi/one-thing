/**
 * Theme System - Granular Semantic Variables
 * Based on Flexoki color palette
 * 130+ variables for precise UI control
 */

@import './flexoki-colors.css';

:root {
  /* ============================================
     Typography
     ============================================ */
  --font-sans: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
    Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Apple Color Emoji',
    'Segoe UI Emoji';
  --font-mono: 'SF Mono', 'Fira Code', 'JetBrains Mono', Menlo, Monaco, Consolas, monospace;

  /* ============================================
     Border Radius
     ============================================ */
  --radius-xs: 4px;
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-full: 9999px;

  /* ============================================
     Spacing Scale
     ============================================ */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;

  /* ============================================
     Accent Color (Customizable)
     Main: 300 shade - for primary accents
     Sub: 100 shade - for highlights, selections
     Light: Lighter variant for hover states
     ============================================ */
  --accent: var(--fx-blue-300);
  --accent-main: var(--fx-blue-300);
  --accent-sub: var(--fx-blue-100);
  --accent-light: var(--fx-blue-100);  /* Used by buttons and gradients */
  --accent-rgb: 67, 133, 190;

  /* ============================================
     Semantic Colors - Danger/Warning/Success
     ============================================ */
  --color-danger: var(--fx-red);
  --color-danger-light: var(--fx-red-light);
  --color-warning: var(--fx-orange);
  --color-warning-light: var(--fx-orange-light);
  --color-success: var(--fx-green);
  --color-success-light: var(--fx-green-light);
  --color-info: var(--fx-cyan);
  --color-info-light: var(--fx-cyan-light);
}

/* ============================================
   DARK THEME - Using Flexoki palette
   NOTE: In dark mode, Flexoki INVERTS the scale:
   - base-50 = #1C1B1A (darkest)
   - base-100 = #282726
   - base-150 = #343331
   - base-950 = #F2F0E5 (lightest)
   ============================================ */
[data-theme='dark'] {
  /* --- Layer Backgrounds (using inverted Flexoki scale) --- */
  --bg-app: var(--fx-base-100);          /* #282726 */
  --bg-sidebar: var(--fx-base-150);      /* #343331 */
  --bg-chat: var(--fx-base-150);         /* #343331 */
  --bg-panel: var(--fx-base-150);        /* #343331 */
  --bg-elevated: var(--fx-base-200);     /* #403E3C */
  --bg-floating: var(--fx-base-300);     /* #575653 */

  /* --- Message Backgrounds --- */
  --bg-message-user: linear-gradient(135deg, var(--fx-base-200) 0%, var(--fx-base-150) 100%);
  --bg-message-user-solid: var(--fx-base-200);
  --bg-message-ai: transparent;
  --bg-message-system: var(--fx-base-150);
  --bg-message-error: rgba(209, 77, 65, 0.12);
  --bg-message-hover: rgba(255, 255, 255, 0.03);

  /* --- Tool Call Backgrounds --- */
  --bg-tool-call: var(--fx-base-150);
  --bg-tool-call-hover: var(--fx-base-200);
  --bg-tool-result: var(--fx-base-150);
  --bg-tool-error: rgba(209, 77, 65, 0.12);
  --bg-tool-success: rgba(135, 154, 57, 0.12);

  /* --- Input Backgrounds --- */
  --bg-input: var(--fx-base-150);
  --bg-input-focus: var(--fx-base-200);
  --bg-input-disabled: var(--fx-base-300);

  /* --- Button Backgrounds --- */
  --bg-btn-primary: var(--accent);
  --bg-btn-primary-hover: var(--accent-light);
  --bg-btn-secondary: var(--fx-base-300);
  --bg-btn-secondary-hover: var(--fx-base-400);
  --bg-btn-ghost: transparent;
  --bg-btn-ghost-hover: var(--fx-base-200);
  --bg-btn-danger: #D14D41;
  --bg-btn-danger-hover: #AF3029;

  /* --- Code Backgrounds --- */
  --bg-code-inline: var(--fx-base-200);
  --bg-code-block: var(--fx-base-150);
  --bg-code-header: var(--fx-base-200);

  /* --- Menu & Popup Backgrounds --- */
  --bg-menu: var(--fx-base-200);
  --bg-menu-item-hover: var(--fx-base-300);
  --bg-menu-item-active: var(--fx-base-400);
  --bg-tooltip: var(--fx-base-800);
  --bg-modal: var(--fx-base-150);
  --bg-modal-overlay: rgba(0, 0, 0, 0.6);

  /* --- Selection & Highlight --- */
  --bg-selected: rgba(67, 133, 190, 0.15);
  --bg-selected-hover: rgba(67, 133, 190, 0.2);
  --bg-highlight: rgba(208, 162, 21, 0.2);
  --bg-hover: rgba(255, 255, 255, 0.04);
  --bg-active: rgba(255, 255, 255, 0.08);

  /* ============================================
     Text Colors - Dark Theme (using inverted Flexoki)
     For light text, use high numbers (800-950)
     ============================================ */

  /* --- Primary Text --- */
  --text-primary: var(--fx-base-950);     /* #F2F0E5 */
  --text-secondary: var(--fx-base-900);   /* #E6E4D9 */
  --text-muted: var(--fx-base-800);       /* #CECDC3 */
  --text-faint: var(--fx-base-700);       /* #B7B5AC */

  /* --- Message Text --- */
  --text-user-primary: var(--fx-base-950);
  --text-user-secondary: var(--fx-base-900);
  --text-ai-primary: var(--fx-base-900);
  --text-ai-secondary: var(--fx-base-800);
  --text-ai-thinking: var(--fx-base-700);
  --text-system: var(--fx-base-700);
  --text-error: var(--fx-red);
  --text-warning: var(--fx-orange);
  --text-success: var(--fx-green);

  /* --- Status Text --- */
  --text-llm-waiting: var(--fx-base-700);
  --text-tool-calling: var(--fx-cyan);
  --text-tool-waiting: var(--fx-base-700);
  --text-streaming: var(--fx-base-800);
  --text-timestamp: var(--fx-base-700);
  --text-timestamp-hover: var(--fx-base-800);

  /* --- Tool Call Text --- */
  --text-tool-name: var(--fx-purple);
  --text-tool-args: var(--fx-base-700);
  --text-tool-result: var(--fx-base-800);
  --text-tool-error: var(--fx-red);
  --text-tool-label: var(--fx-base-700);

  /* --- Sidebar Text --- */
  --text-sidebar-title: var(--fx-base-900);
  --text-sidebar-item: var(--fx-base-800);
  --text-sidebar-item-active: var(--accent);
  --text-sidebar-item-hover: var(--fx-base-950);
  --text-sidebar-muted: var(--fx-base-700);
  --text-sidebar-count: var(--fx-base-700);

  /* --- Input Text --- */
  --text-input: var(--fx-base-950);
  --text-input-placeholder: var(--fx-base-700);
  --text-input-disabled: var(--fx-base-700);

  /* --- Code Text --- */
  --text-code-inline: var(--fx-magenta);
  --text-code-block: var(--fx-base-900);
  --text-code-comment: var(--fx-base-500);
  --text-code-keyword: var(--fx-purple);
  --text-code-string: var(--fx-green);
  --text-code-number: var(--fx-orange);
  --text-code-function: var(--fx-blue);
  --text-code-variable: var(--fx-cyan);
  --text-code-operator: var(--fx-base-700);

  /* --- Link Text --- */
  --text-link: var(--fx-cyan);
  --text-link-hover: var(--fx-cyan-light);
  --text-link-visited: var(--fx-purple);
  --text-link-external: var(--fx-cyan);

  /* --- Button Text --- */
  --text-btn-primary: var(--fx-black);
  --text-btn-secondary: var(--fx-base-900);
  --text-btn-ghost: var(--fx-base-800);
  --text-btn-danger: var(--fx-black);
  --text-btn-disabled: var(--fx-base-700);

  /* --- Form Text --- */
  --text-label: var(--fx-base-800);
  --text-helper: var(--fx-base-700);
  --text-validation-error: var(--fx-red);
  --text-validation-success: var(--fx-green);

  /* --- Menu Text --- */
  --text-menu-item: var(--fx-base-800);
  --text-menu-item-hover: var(--fx-base-900);
  --text-menu-item-active: var(--accent);
  --text-menu-header: var(--fx-base-700);
  --text-tooltip: var(--fx-black);
  --text-modal-title: var(--fx-base-900);
  --text-modal-body: var(--fx-base-800);

  /* ============================================
     Border Colors - Dark Theme (using inverted Flexoki)
     ============================================ */
  --border-default: var(--fx-base-300);   /* #575653 */
  --border-subtle: var(--fx-base-200);    /* #403E3C */
  --border-strong: var(--fx-base-400);    /* #6F6E69 */
  --border-accent: var(--accent);
  --border-error: var(--fx-red);
  --border-success: var(--fx-green);
  --border-warning: var(--fx-orange);
  --border-input: var(--fx-base-300);
  --border-input-focus: var(--accent);
  --border-input-error: var(--fx-red);
  --border-message: var(--fx-base-200);
  --border-message-user: var(--fx-base-300);
  --border-code: var(--fx-base-300);
  --border-divider: var(--fx-base-200);

  /* ============================================
     Shadows - Dark Theme
     ============================================ */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.2);
  --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.25);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.35);
  --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.4);
  --shadow-inner: inset 0 2px 4px rgba(0, 0, 0, 0.15);
  --shadow-glow-accent: 0 0 20px rgba(67, 133, 190, 0.2);
  --shadow-glow-error: 0 0 20px rgba(209, 77, 65, 0.2);
  --shadow-elevated: 0 8px 32px rgba(0, 0, 0, 0.4);
  --shadow-floating: 0 12px 48px rgba(0, 0, 0, 0.5);

  /* ============================================
     Effects - Dark Theme
     ============================================ */
  --gradient-user-bubble: linear-gradient(135deg, var(--fx-base-200) 0%, var(--fx-base-150) 100%);
  --gradient-ai-bubble: linear-gradient(135deg, transparent 0%, transparent 100%);
  --gradient-accent: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
  --overlay-hover: rgba(255, 255, 255, 0.04);
  --overlay-active: rgba(255, 255, 255, 0.08);
  --overlay-disabled: rgba(0, 0, 0, 0.5);
  --blur-backdrop: 24px;

  /* ============================================
     Diff Colors (for code diff views)
     ============================================ */
  --diff-add-bg: rgba(135, 154, 57, 0.15);
  --diff-add-text: var(--text-success);
  --diff-del-bg: rgba(209, 77, 65, 0.15);
  --diff-del-text: var(--text-error);
  --diff-hunk-bg: rgba(135, 135, 135, 0.08);
  --diff-hunk-text: var(--text-muted);

  /* RGB triplets for transparency patterns */
  --color-success-rgb: 135, 154, 57;
  --color-danger-rgb: 209, 77, 65;
  --color-warning-rgb: 218, 112, 44;

  /* ============================================
     Legacy Compatibility Variables
     ============================================ */
  --bg: var(--bg-app);
  --bg-rgb: 40, 39, 38;        /* fx-base-100 in dark mode */
  --chat-canvas: var(--bg-chat);
  --chat-canvas-rgb: 52, 51, 49;  /* fx-base-150 in dark mode */
  --panel: var(--bg-panel);
  --panel-2: var(--bg-sidebar);
  --muted: var(--text-muted);
  --text: var(--text-primary);
  --border: var(--border-default);
  --hover: var(--bg-hover);
  --active: var(--bg-active);
  --shadow: var(--shadow-lg);
  --shadow-glow: var(--shadow-glow-accent);
  --accent-secondary: var(--accent-light);
  --danger: var(--fx-red);
  --user-bubble: var(--bg-message-user);
  --user-bubble-border: var(--border-message-user);
  --ai-text: var(--text-ai-primary);
  --session-highlight: var(--bg-selected);
}

/* ============================================
   LIGHT THEME
   ============================================ */
[data-theme='light'] {
  /* --- Layer Backgrounds --- */
  --bg-app: #E6E4D9;
  --bg-sidebar: #F2F0E5;
  --bg-chat: #FFFCF0;
  --bg-panel: #FFFCF0;
  --bg-elevated: #FFFCF0;
  --bg-floating: #FFFCF0;

  /* --- Message Backgrounds --- */
  --bg-message-user: linear-gradient(135deg, #E6E4D9 0%, #F2F0E5 100%);
  --bg-message-user-solid: #E6E4D9;
  --bg-message-ai: transparent;
  --bg-message-system: #F2F0E5;
  --bg-message-error: #FCEDEB;
  --bg-message-hover: rgba(0, 0, 0, 0.02);

  /* --- Tool Call Backgrounds --- */
  --bg-tool-call: #F2F0E5;
  --bg-tool-call-hover: #E6E4D9;
  --bg-tool-result: #F2F0E5;
  --bg-tool-error: #FCEDEB;
  --bg-tool-success: #F0F4E4;

  /* --- Input Backgrounds --- */
  --bg-input: #FFFCF0;
  --bg-input-focus: #FFFCF0;
  --bg-input-disabled: #E6E4D9;

  /* --- Button Backgrounds --- */
  --bg-btn-primary: var(--accent);
  --bg-btn-primary-hover: var(--accent-light);
  --bg-btn-secondary: #E6E4D9;
  --bg-btn-secondary-hover: #DAD8CE;
  --bg-btn-ghost: transparent;
  --bg-btn-ghost-hover: #E6E4D9;
  --bg-btn-danger: #AF3029;
  --bg-btn-danger-hover: #D14D41;

  /* --- Code Backgrounds --- */
  --bg-code-inline: #E6E4D9;
  --bg-code-block: #F2F0E5;
  --bg-code-header: #E6E4D9;

  /* --- Menu & Popup Backgrounds --- */
  --bg-menu: #FFFCF0;
  --bg-menu-item-hover: #F2F0E5;
  --bg-menu-item-active: #E6E4D9;
  --bg-tooltip: #282726;
  --bg-modal: #FFFCF0;
  --bg-modal-overlay: rgba(16, 15, 15, 0.5);

  /* --- Selection & Highlight --- */
  --bg-selected: rgba(32, 94, 166, 0.1);
  --bg-selected-hover: rgba(32, 94, 166, 0.15);
  --bg-highlight: #F9E6BC;
  --bg-hover: rgba(0, 0, 0, 0.04);
  --bg-active: rgba(0, 0, 0, 0.06);

  /* ============================================
     Text Colors - Light Theme (Low Contrast)
     ============================================ */

  /* --- Primary Text --- */
  --text-primary: #575653;
  --text-secondary: #6F6E69;
  --text-muted: #878580;
  --text-faint: #9F9D96;

  /* --- Message Text --- */
  --text-user-primary: #575653;
  --text-user-secondary: #6F6E69;
  --text-ai-primary: #575653;
  --text-ai-secondary: #6F6E69;
  --text-ai-thinking: #9F9D96;
  --text-system: #878580;
  --text-error: #AF3029;
  --text-warning: #BC5215;
  --text-success: #66800B;

  /* --- Status Text --- */
  --text-llm-waiting: #9F9D96;
  --text-tool-calling: #24837B;
  --text-tool-waiting: #9F9D96;
  --text-streaming: #6F6E69;
  --text-timestamp: #9F9D96;
  --text-timestamp-hover: #878580;

  /* --- Tool Call Text --- */
  --text-tool-name: #5E409D;
  --text-tool-args: #6F6E69;
  --text-tool-result: #575653;
  --text-tool-error: #AF3029;
  --text-tool-label: #878580;

  /* --- Sidebar Text --- */
  --text-sidebar-title: #100F0F;
  --text-sidebar-item: #575653;
  --text-sidebar-item-active: var(--accent);
  --text-sidebar-item-hover: #100F0F;
  --text-sidebar-muted: #878580;
  --text-sidebar-count: #9F9D96;

  /* --- Input Text --- */
  --text-input: #575653;
  --text-input-placeholder: #9F9D96;
  --text-input-disabled: #9F9D96;

  /* --- Code Text --- */
  --text-code-inline: #A02F6F;
  --text-code-block: #403E3C;
  --text-code-comment: #878580;
  --text-code-keyword: #5E409D;
  --text-code-string: #66800B;
  --text-code-number: #BC5215;
  --text-code-function: #205EA6;
  --text-code-variable: #24837B;
  --text-code-operator: #6F6E69;

  /* --- Link Text --- */
  --text-link: #24837B;
  --text-link-hover: #3AA99F;
  --text-link-visited: #5E409D;
  --text-link-external: #24837B;

  /* --- Button Text --- */
  --text-btn-primary: #FFFCF0;
  --text-btn-secondary: #575653;
  --text-btn-ghost: #575653;
  --text-btn-danger: #FFFCF0;
  --text-btn-disabled: #9F9D96;

  /* --- Form Text --- */
  --text-label: #575653;
  --text-helper: #878580;
  --text-validation-error: #AF3029;
  --text-validation-success: #66800B;

  /* --- Menu Text --- */
  --text-menu-item: #575653;
  --text-menu-item-hover: #100F0F;
  --text-menu-item-active: var(--accent);
  --text-menu-header: #878580;
  --text-tooltip: #FFFCF0;
  --text-modal-title: #100F0F;
  --text-modal-body: #575653;

  /* ============================================
     Border Colors - Light Theme
     ============================================ */
  --border-default: #CECDC3;
  --border-subtle: #E6E4D9;
  --border-strong: #B7B5AC;
  --border-accent: var(--accent);
  --border-error: #AF3029;
  --border-success: #66800B;
  --border-warning: #BC5215;
  --border-input: #CECDC3;
  --border-input-focus: var(--accent);
  --border-input-error: #AF3029;
  --border-message: #E6E4D9;
  --border-message-user: #CECDC3;
  --border-code: #CECDC3;
  --border-divider: #DAD8CE;

  /* ============================================
     Shadows - Light Theme
     ============================================ */
  --shadow-xs: 0 1px 2px rgba(16, 15, 15, 0.05);
  --shadow-sm: 0 2px 4px rgba(16, 15, 15, 0.06);
  --shadow-md: 0 4px 12px rgba(16, 15, 15, 0.08);
  --shadow-lg: 0 8px 24px rgba(16, 15, 15, 0.1);
  --shadow-xl: 0 16px 48px rgba(16, 15, 15, 0.12);
  --shadow-inner: inset 0 2px 4px rgba(16, 15, 15, 0.05);
  --shadow-glow-accent: 0 0 20px rgba(32, 94, 166, 0.15);
  --shadow-glow-error: 0 0 20px rgba(175, 48, 41, 0.15);
  --shadow-elevated: 0 8px 32px rgba(16, 15, 15, 0.08);
  --shadow-floating: 0 12px 48px rgba(16, 15, 15, 0.15);

  /* ============================================
     Effects - Light Theme
     ============================================ */
  --gradient-user-bubble: linear-gradient(135deg, #E6E4D9 0%, #F2F0E5 100%);
  --gradient-ai-bubble: linear-gradient(135deg, transparent 0%, transparent 100%);
  --gradient-accent: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
  --overlay-hover: rgba(0, 0, 0, 0.04);
  --overlay-active: rgba(0, 0, 0, 0.06);
  --overlay-disabled: rgba(255, 255, 255, 0.5);

  /* ============================================
     Diff Colors (for code diff views)
     ============================================ */
  --diff-add-bg: rgba(102, 128, 11, 0.12);
  --diff-add-text: var(--text-success);
  --diff-del-bg: rgba(175, 48, 41, 0.12);
  --diff-del-text: var(--text-error);
  --diff-hunk-bg: rgba(0, 0, 0, 0.04);
  --diff-hunk-text: var(--text-muted);

  /* RGB triplets for transparency patterns */
  --color-success-rgb: 102, 128, 11;
  --color-danger-rgb: 175, 48, 41;
  --color-warning-rgb: 188, 82, 21;

  /* ============================================
     Legacy Compatibility Variables - Light
     ============================================ */
  --bg: var(--bg-app);
  --bg-rgb: 230, 228, 217;
  --chat-canvas: var(--bg-chat);
  --chat-canvas-rgb: 255, 252, 240;
  --panel: var(--bg-panel);
  --panel-2: var(--bg-sidebar);
  --muted: var(--text-muted);
  --text: var(--text-primary);
  --border: var(--border-default);
  --hover: var(--bg-hover);
  --active: var(--bg-active);
  --shadow: var(--shadow-lg);
  --shadow-glow: var(--shadow-glow-accent);
  --accent-secondary: var(--accent-light);
  --danger: #AF3029;
  --user-bubble: var(--bg-message-user);
  --user-bubble-border: var(--border-message-user);
  --ai-text: var(--text-ai-primary);
  --session-highlight: var(--bg-selected);
}

/* ============================================
   Accent Color Themes
   Dark mode: Main=300, Sub=100
   Light mode: Main=300, Sub=200
   ============================================ */

/* Blue (Default) */
[data-color-theme='blue'] {
  --accent: var(--fx-blue-300);
  --accent-main: var(--fx-blue-300);
  --accent-sub: var(--fx-blue-100);
  --accent-rgb: 67, 133, 190;
}
[data-theme='light'][data-color-theme='blue'] {
  --accent-main: var(--fx-blue-300);
  --accent-sub: var(--fx-blue-200);
}

/* Purple */
[data-color-theme='purple'] {
  --accent: var(--fx-purple-300);
  --accent-main: var(--fx-purple-300);
  --accent-sub: var(--fx-purple-100);
  --accent-rgb: 139, 126, 200;
}
[data-theme='light'][data-color-theme='purple'] {
  --accent-main: var(--fx-purple-300);
  --accent-sub: var(--fx-purple-200);
}

/* Green */
[data-color-theme='green'] {
  --accent: var(--fx-green-300);
  --accent-main: var(--fx-green-300);
  --accent-sub: var(--fx-green-100);
  --accent-rgb: 135, 154, 57;
}
[data-theme='light'][data-color-theme='green'] {
  --accent-main: var(--fx-green-300);
  --accent-sub: var(--fx-green-200);
}

/* Orange */
[data-color-theme='orange'] {
  --accent: var(--fx-orange-300);
  --accent-main: var(--fx-orange-300);
  --accent-sub: var(--fx-orange-100);
  --accent-rgb: 239, 147, 81;
}
[data-theme='light'][data-color-theme='orange'] {
  --accent-main: var(--fx-orange-300);
  --accent-sub: var(--fx-orange-200);
}

/* Cyan */
[data-color-theme='cyan'] {
  --accent: var(--fx-cyan-300);
  --accent-main: var(--fx-cyan-300);
  --accent-sub: var(--fx-cyan-100);
  --accent-rgb: 58, 169, 159;
}
[data-theme='light'][data-color-theme='cyan'] {
  --accent-main: var(--fx-cyan-300);
  --accent-sub: var(--fx-cyan-200);
}

/* Red */
[data-color-theme='red'] {
  --accent: var(--fx-red-300);
  --accent-main: var(--fx-red-300);
  --accent-sub: var(--fx-red-100);
  --accent-rgb: 230, 127, 117;
}
[data-theme='light'][data-color-theme='red'] {
  --accent-main: var(--fx-red-300);
  --accent-sub: var(--fx-red-200);
}

/* Magenta / Pink */
[data-color-theme='pink'] {
  --accent: var(--fx-magenta-300);
  --accent-main: var(--fx-magenta-300);
  --accent-sub: var(--fx-magenta-100);
  --accent-rgb: 206, 93, 151;
}
[data-theme='light'][data-color-theme='pink'] {
  --accent-main: var(--fx-magenta-300);
  --accent-sub: var(--fx-magenta-200);
}
