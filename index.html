<!DOCTYPE html>
<html lang="en" data-theme="dark" data-color-theme="blue" data-base-theme="obsidian">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Chat</title>
    <script>
      // Apply cached theme IMMEDIATELY to prevent flash
      // Uses inline styles on documentElement for HIGHEST CSS specificity
      // This cannot be overridden by any stylesheet rules
      (function() {
        try {
          var cachedCss = localStorage.getItem('cached-theme-css');

          if (cachedCss) {
            var variables = JSON.parse(cachedCss);

            // Apply CSS variables directly to documentElement.style (inline style = highest specificity)
            // This prevents variables.css from overriding these values
            for (var key in variables) {
              if (variables.hasOwnProperty(key)) {
                document.documentElement.style.setProperty(key, variables[key]);
              }
            }

            // Set background color
            var bgColor = variables['--bg-app'] || variables['--bg'] || '#282726';
            document.documentElement.style.backgroundColor = bgColor;
            document.documentElement.style.margin = '0';
            document.documentElement.style.padding = '0';

            console.log('[Theme] Applied cached CSS via inline style (highest specificity)');
          } else {
            // No cache - just set basic background (will be overridden by theme later)
            document.documentElement.style.backgroundColor = '#282726';
            document.documentElement.style.margin = '0';
            document.documentElement.style.padding = '0';
          }
        } catch (e) {
          console.warn('[Theme] Failed to apply cached theme:', e);
          document.documentElement.style.backgroundColor = '#282726';
        }
      })();
    </script>
    <script>
      // Sync read light/dark mode from URL hash or localStorage
      (function() {
        var hash = window.location.hash;
        var theme = null;
        var colorTheme = null;

        // Check URL hash for theme parameter
        if (hash.includes('theme=light')) {
          theme = 'light';
        } else if (hash.includes('theme=dark')) {
          theme = 'dark';
        } else {
          theme = localStorage.getItem('cached-theme');
        }

        // Check for colorTheme parameter
        var colorMatch = hash.match(/colorTheme=([a-z]+)/);
        if (colorMatch) {
          colorTheme = colorMatch[1];
        } else {
          colorTheme = localStorage.getItem('cached-color-theme');
        }

        if (theme === 'light' || theme === 'dark') {
          document.documentElement.setAttribute('data-theme', theme);
        }
        if (colorTheme) {
          document.documentElement.setAttribute('data-color-theme', colorTheme);
        }
      })();
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/renderer/main.ts"></script>
  </body>
</html>
