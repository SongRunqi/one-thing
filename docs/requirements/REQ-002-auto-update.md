# REQ-002: åº”ç”¨è‡ªåŠ¨æ›´æ–°

> çŠ¶æ€: å·²ç¡®è®¤ï¼ˆæ–¹æ¡ˆBï¼šå¼•å¯¼æ‰‹åŠ¨ä¸‹è½½ï¼‰ | åˆ›å»º: 2026-02-08 | PM: Qiqi

## 1. éœ€æ±‚æè¿°

### èƒŒæ™¯
0neThing æ˜¯ Electron æ¡Œé¢åº”ç”¨ï¼Œç›®å‰ç”¨æˆ·éœ€è¦æ‰‹åŠ¨ä¸‹è½½æ–°ç‰ˆæœ¬ã€‚éœ€è¦å®ç°åŸºäº GitHub Releases çš„è‡ªåŠ¨æ›´æ–°åŠŸèƒ½ï¼Œè®©ç”¨æˆ·èƒ½åœ¨åº”ç”¨å†…æ£€æµ‹å¹¶å®‰è£…æ›´æ–°ã€‚

### ç”¨æˆ·æ•…äº‹
- ä½œä¸ºç”¨æˆ·ï¼Œå½“æœ‰æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶ï¼Œæˆ‘å¸Œæœ›åº”ç”¨è‡ªåŠ¨é€šçŸ¥æˆ‘å¹¶æä¾›ä¸€é”®æ›´æ–°
- ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘å¸Œæœ›å¯ä»¥é€‰æ‹©ç«‹å³æ›´æ–°æˆ–ç¨åæ›´æ–°
- ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘å¸Œæœ›æ›´æ–°è¿‡ç¨‹ä¸ä¼šä¸¢å¤±æˆ‘çš„æ•°æ®å’Œè®¾ç½®

## 2. åŠŸèƒ½è®¾è®¡

### æ›´æ–°æµç¨‹

```
åº”ç”¨å¯åŠ¨ â†’ æ£€æŸ¥æ›´æ–° â†’ æœ‰æ–°ç‰ˆæœ¬ï¼Ÿ
                         â”œâ”€ æ˜¯ â†’ æ˜¾ç¤ºæ›´æ–°æç¤º â†’ ç”¨æˆ·é€‰æ‹©
                         â”‚                       â”œâ”€ ç«‹å³æ›´æ–° â†’ ä¸‹è½½ â†’ å®‰è£… â†’ é‡å¯
                         â”‚                       â””â”€ ç¨åæé†’
                         â””â”€ å¦ â†’ é™é»˜
```

### æ›´æ–°æº
- **GitHub Releases**ï¼ˆ`SongRunqi/one-thing`ï¼‰
- ä½¿ç”¨ `electron-updater` çš„ GitHub provider

### äº¤äº’è®¾è®¡

#### è‡ªåŠ¨æ£€æŸ¥
- åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°ï¼ˆé™é»˜ï¼‰
- æ¯ 4 å°æ—¶æ£€æŸ¥ä¸€æ¬¡

#### æ›´æ–°æç¤º
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‰ å‘ç°æ–°ç‰ˆæœ¬ v0.2.0               â”‚
â”‚                                     â”‚
â”‚ æ›´æ–°å†…å®¹ï¼š                          â”‚
â”‚ â€¢ æ–°å¢ Tool æ‹’ç»æ¨¡å¼               â”‚
â”‚ â€¢ ä¿®å¤ ESLint é…ç½®                  â”‚
â”‚ â€¢ æ€§èƒ½ä¼˜åŒ–                          â”‚
â”‚                                     â”‚
â”‚ ä¸‹è½½å¤§å°ï¼šçº¦ XXX MB                 â”‚
â”‚                                     â”‚
â”‚         [ç¨åæé†’]  [ç«‹å³æ›´æ–°]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸‹è½½è¿›åº¦
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­£åœ¨ä¸‹è½½æ›´æ–° v0.2.0                â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘  76%         â”‚
â”‚ 156 MB / 213 MB                     â”‚
â”‚                                     â”‚
â”‚              [åå°ä¸‹è½½]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®‰è£…æç¤º
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ›´æ–°å·²ä¸‹è½½å®Œæˆ                      â”‚
â”‚ é‡å¯åº”ç”¨ä»¥å®Œæˆå®‰è£…                  â”‚
â”‚                                     â”‚
â”‚         [ç¨å]  [ç«‹å³é‡å¯]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾ç½®é¡¹
- Settings â†’ General ä¸­æ·»åŠ ï¼š
  - â˜‘ è‡ªåŠ¨æ£€æŸ¥æ›´æ–°ï¼ˆé»˜è®¤å¼€å¯ï¼‰
  - â˜‘ è‡ªåŠ¨ä¸‹è½½æ›´æ–°ï¼ˆé»˜è®¤å…³é—­ï¼‰
  - å½“å‰ç‰ˆæœ¬å·æ˜¾ç¤º
  - [æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°] æŒ‰é’®

## 3. æŠ€æœ¯è®¾è®¡

### ä¾èµ–
- `electron-updater`ï¼ˆelectron-builder ç”Ÿæ€ï¼‰

### å½±å“æ¨¡å—

| æ¨¡å— | æ–‡ä»¶ | æ”¹åŠ¨ |
|------|------|------|
| ä¸»è¿›ç¨‹ | `src/main/updater.ts` (æ–°å»º) | autoUpdater é€»è¾‘ |
| ä¸»è¿›ç¨‹ | `src/main/index.ts` | åˆå§‹åŒ– updater |
| IPC | `src/shared/ipc.ts` | æ–°å¢æ›´æ–°ç›¸å…³ channel |
| é¢„åŠ è½½ | `src/preload/index.ts` | æš´éœ²æ›´æ–° API |
| UI | `src/renderer/components/UpdateDialog.vue` (æ–°å»º) | æ›´æ–°æç¤º UI |
| UI | `src/renderer/components/settings/GeneralSettingsTab.vue` | æ·»åŠ æ›´æ–°è®¾ç½® |
| æ„å»º | `electron-builder.yml` æˆ– `package.json` | é…ç½® publish |
| æ„å»º | `.github/workflows/build.yml` | ç¡®ä¿ Release ä¸Šä¼ æ­£ç¡®çš„ artifacts |

### æ•°æ®ç»“æ„

```typescript
// IPC channels
'updater:check'          // æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°
'updater:download'       // å¼€å§‹ä¸‹è½½
'updater:install'        // å®‰è£…å¹¶é‡å¯
'updater:status'         // è·å–æ›´æ–°çŠ¶æ€

// æ›´æ–°çŠ¶æ€
interface UpdateStatus {
  checking: boolean
  available: boolean
  downloading: boolean
  downloaded: boolean
  progress?: {
    percent: number
    bytesPerSecond: number
    total: number
    transferred: number
  }
  version?: string
  releaseNotes?: string
  error?: string
}
```

### electron-builder é…ç½®

```json
{
  "publish": {
    "provider": "github",
    "owner": "SongRunqi",
    "repo": "one-thing"
  }
}
```

### å¹³å°æ”¯æŒ

| å¹³å° | æ›´æ–°æ–¹å¼ | æ–‡ä»¶æ ¼å¼ |
|------|----------|----------|
| macOS | DMG / zip | `.dmg`, `.zip` + `latest-mac.yml` |
| Windows | NSIS | `.exe` + `latest.yml` |
| Linux | AppImage | `.AppImage` + `latest-linux.yml` |

### ä»£ç ç­¾å
- macOS: éœ€è¦ Apple Developer è¯ä¹¦ï¼ˆå¦åˆ™ autoUpdater æ— æ³•éªŒè¯æ›´æ–°ï¼‰
- Windows: å¯é€‰ï¼ˆæ— ç­¾åæ—¶ç”¨æˆ·ä¼šçœ‹åˆ° SmartScreen è­¦å‘Šï¼‰
- **æ³¨æ„**: å¦‚æœæ²¡æœ‰ä»£ç ç­¾åï¼ŒmacOS çš„ autoUpdater ä¸ä¼šå·¥ä½œï¼Œéœ€è¦ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆï¼ˆæç¤ºç”¨æˆ·æ‰‹åŠ¨ä¸‹è½½ï¼‰

## 4. éªŒæ”¶æ ‡å‡†

- [ ] åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥ GitHub Releases
- [ ] æœ‰æ–°ç‰ˆæœ¬æ—¶å¼¹å‡ºæ›´æ–°æç¤ºï¼ˆæ˜¾ç¤ºç‰ˆæœ¬å·å’Œæ›´æ–°å†…å®¹ï¼‰
- [ ] ç”¨æˆ·å¯ä»¥é€‰æ‹©ç«‹å³æ›´æ–°æˆ–ç¨å
- [ ] ä¸‹è½½æ—¶æ˜¾ç¤ºè¿›åº¦æ¡
- [ ] ä¸‹è½½å®Œæˆåæç¤ºé‡å¯
- [ ] Settings ä¸­å¯ä»¥å…³é—­è‡ªåŠ¨æ£€æŸ¥
- [ ] Settings ä¸­å¯ä»¥æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°
- [ ] æ›´æ–°ä¸ä¸¢å¤±ç”¨æˆ·æ•°æ®

## 5. å¼€å‘ä¼°æ—¶

| ä»»åŠ¡ | é¢„ä¼° |
|------|------|
| å®‰è£…ä¾èµ– + electron-builder é…ç½® | 15 åˆ†é’Ÿ |
| updater.ts ä¸»è¿›ç¨‹é€»è¾‘ | 45 åˆ†é’Ÿ |
| IPC + preload | 15 åˆ†é’Ÿ |
| UpdateDialog.vue UI | 30 åˆ†é’Ÿ |
| Settings è®¾ç½®é¡¹ | 20 åˆ†é’Ÿ |
| GitHub Actions è°ƒæ•´ | 15 åˆ†é’Ÿ |
| æµ‹è¯• | 30 åˆ†é’Ÿ |
| **åˆè®¡** | ~3 å°æ—¶ |

## 6. é£é™©

| é£é™© | ç­‰çº§ | è¯´æ˜ |
|------|------|------|
| macOS ä»£ç ç­¾å | **é«˜** | æ²¡æœ‰ Apple Developer è¯ä¹¦ï¼ŒautoUpdater æ— æ³•éªŒè¯ç­¾å |
| GitHub API é™æµ | ä½ | æ¯å°æ—¶ 60 æ¬¡åŒ¿åè¯·æ±‚ï¼Œ4h æ£€æŸ¥ä¸€æ¬¡è¶³å¤Ÿ |
| å¤§æ–‡ä»¶ä¸‹è½½ | ä½ | DMG ~213MBï¼Œéœ€è¦è¿›åº¦æç¤º |

### macOS ç­¾åé—®é¢˜æ–¹æ¡ˆ
- **æ–¹æ¡ˆ A**: è´­ä¹° Apple Developer è¯ä¹¦ï¼ˆ$99/å¹´ï¼‰â†’ å®Œæ•´ autoUpdater
- **æ–¹æ¡ˆ B**: ä¸ç­¾åï¼Œæ£€æµ‹åˆ°æ›´æ–°åå¼•å¯¼ç”¨æˆ·æ‰“å¼€ GitHub Releases é¡µé¢æ‰‹åŠ¨ä¸‹è½½
- **å»ºè®®**: å…ˆç”¨æ–¹æ¡ˆ Bï¼Œåç»­éœ€è¦æ—¶å‡çº§åˆ°æ–¹æ¡ˆ A

## 7. ä¾èµ–å…³ç³»

- ä¾èµ– Build and Release workflow æ­£ç¡®ä¸Šä¼  artifacts åˆ° GitHub Releases
- éœ€è¦ç¡®è®¤å½“å‰ Release ä¸­åŒ…å« `latest-mac.yml` ç­‰æ›´æ–°æè¿°æ–‡ä»¶

---

*PM: Qiqi | å¼€å‘: TBD | æ—¥æœŸ: 2026-02-08*
